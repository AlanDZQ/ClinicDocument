webpackJsonp([3],{"24ch":function(e,t,a){t=e.exports=a("FZ+f")(!0),t.push([e.i,".plyt-catman-cattree[data-v-d97caeb6]{border:0}.plyt-catman-carditem[data-v-d97caeb6]{margin-bottom:16px}.plyt-catman-btn-fill[data-v-d97caeb6]{width:100%}.plyt-catman-cardbutton[data-v-d97caeb6]{-webkit-box-shadow:0 2px 4px 0 rgba(0,0,0,.12),0 0 6px 0 rgba(0,0,0,.04);box-shadow:0 2px 4px 0 rgba(0,0,0,.12),0 0 6px 0 rgba(0,0,0,.04);height:44px}.plyt-catman-search[data-v-d97caeb6]{height:44px}.plyt-catman-search input[data-v-d97caeb6]{height:44px;-webkit-box-shadow:0 2px 4px 0 rgba(0,0,0,.12),0 0 6px 0 rgba(0,0,0,.04);box-shadow:0 2px 4px 0 rgba(0,0,0,.12),0 0 6px 0 rgba(0,0,0,.04)}.plyt-catman-cattitle[data-v-d97caeb6]{margin-bottom:24px}.el-button-group[data-v-d97caeb6]{margin-bottom:12px}","",{version:3,sources:["C:/Users/zwh/IdeaProjects/my-project/src/views/Admin/templateManagement/editCategory.vue"],names:[],mappings:"AACA,sCACE,QAAQ,CACT,AACD,uCACE,kBAAkB,CACnB,AACD,uCACE,UAAW,CACZ,AACD,yCACE,yEAAiF,AACzE,iEAAyE,AACjF,WAAY,CACb,AACD,qCACE,WAAa,CACd,AACD,2CACE,YAAa,AACb,yEAAiF,AACzE,gEAAwE,CACjF,AACD,uCACE,kBAAmB,CACpB,AACD,kCACE,kBAAmB,CACpB",file:"editCategory.vue",sourcesContent:["\n.plyt-catman-cattree[data-v-d97caeb6] {\n  border:0\n}\n.plyt-catman-carditem[data-v-d97caeb6]{\n  margin-bottom:16px\n}\n.plyt-catman-btn-fill[data-v-d97caeb6]{\n  width: 100%\n}\n.plyt-catman-cardbutton[data-v-d97caeb6]{\n  -webkit-box-shadow: 0 2px 4px 0 rgba(0, 0, 0, .12), 0 0 6px 0 rgba(0, 0, 0, .04);\n          box-shadow: 0 2px 4px 0 rgba(0, 0, 0, .12), 0 0 6px 0 rgba(0, 0, 0, .04);\n  height: 44px\n}\n.plyt-catman-search[data-v-d97caeb6]{\n  height: 44px;\n}\n.plyt-catman-search input[data-v-d97caeb6]{\n  height: 44px;\n  -webkit-box-shadow: 0 2px 4px 0 rgba(0, 0, 0, .12), 0 0 6px 0 rgba(0, 0, 0, .04);\n          box-shadow: 0 2px 4px 0 rgba(0, 0, 0, .12), 0 0 6px 0 rgba(0, 0, 0, .04)\n}\n.plyt-catman-cattitle[data-v-d97caeb6]{\n  margin-bottom: 24px\n}\n.el-button-group[data-v-d97caeb6]{\n  margin-bottom: 12px\n}\n"],sourceRoot:""}])},"2x2i":function(e,t,a){var r=a("24ch");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("2b553dab",r,!0)},"6OYX":function(e,t,a){"use strict";function r(e){a("2x2i")}Object.defineProperty(t,"__esModule",{value:!0});var s=a("eHDt"),o=a("BD1O"),c=a("VU/8"),n=r,i=c(s.a,o.a,!1,n,"data-v-d97caeb6",null);t.default=i.exports},BD1O:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:24,type:"flex"}},[a("el-col",{style:{"min-width":" 240px"},attrs:{span:6}},[a("el-button",{staticClass:"plyt-catman-carditem plyt-catman-cardbutton plyt-catman-btn-fill",attrs:{type:"success"},on:{click:e.createCategory}},[a("i",{staticClass:"el-icon-plus",attrs:{"aria-hidden":"true"}}),e._v("Create a new category\n      ")]),e._v(" "),a("el-input",{staticClass:"plyt-catman-carditem plyt-catman-search",attrs:{placeholder:"Search category...","suffix-icon":"el-icon-search"},model:{value:e.filterKeyword,callback:function(t){e.filterKeyword=t},expression:"filterKeyword"}}),e._v(" "),a("el-card",[a("el-tree",{ref:"catTree",staticClass:"plyt-catman-cattree",attrs:{data:e.categoryTree,props:e.categoryProps,"filter-node-method":e.categoryFilter,"highlight-current":"","node-key":"value","expand-on-click-node":!1},on:{"node-click":e.onTreeItemClicked}})],1)],1),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.selectedCategoryName.length,expression:"selectedCategoryName.length"}]},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:16}},[a("h2",{staticClass:"plyt-catman-cattitle"},[e._v(e._s(e.selectedCategory.name))])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-popover",{ref:"deleteCatPopover",attrs:{placement:"bottom",width:"160"},model:{value:e.deleteCatPopoverVisible,callback:function(t){e.deleteCatPopoverVisible=t},expression:"deleteCatPopoverVisible"}},[a("p",{staticStyle:{margin:"8px"}},[e._v("Are you sure?")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){e.deleteCategory(),e.deleteCatPopoverVisible=!1}}},[e._v("Yes")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){e.deleteCatPopoverVisible=!1}}},[e._v("No")])],1)]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:deleteCatPopover",arg:"deleteCatPopover"}],staticStyle:{float:"right"},attrs:{type:"danger"}},[a("i",{staticClass:"fa fa-trash-o",attrs:{"aria-hidden":"true"}}),e._v("Delete Category\n            ")])],1)],1),e._v(" "),a("h4",{staticStyle:{margin:"20px 0"}},[e._v("Category Name")]),e._v(" "),a("div",[a("el-input",{model:{value:e.selectedCategoryName,callback:function(t){e.selectedCategoryName=t},expression:"selectedCategoryName"}},[a("el-button",{attrs:{slot:"append",type:"plain"},on:{click:e.updateCategoryName},slot:"append"},[a("i",{staticClass:"el-icon-check",attrs:{"aria-hidden":"true"}}),e._v(" Apply\n            ")])],1)],1),e._v(" "),a("h4",{staticStyle:{margin:"20px 0"}},[e._v("Parent Category")]),e._v(" "),a("div",[a("el-cascader",{ref:"catCascader",attrs:{"expand-trigger":"click",options:e.categoryCascader,props:e.categoryProps,"change-on-select":!0,"show-all-levels":!1},model:{value:e.selectedParentCategory,callback:function(t){e.selectedParentCategory=t},expression:"selectedParentCategory"}}),e._v(" "),a("el-button",{attrs:{type:"plain"},on:{click:e.updateCategoryParent}},[a("i",{staticClass:"el-icon-check",attrs:{"aria-hidden":"true"}}),e._v(" Apply\n          ")])],1)],1)],1)],1)],1)},s=[],o={render:r,staticRenderFns:s};t.a=o},eHDt:function(e,t,a){"use strict";var r=a("mvHQ"),s=a.n(r);t.a={name:"template",data:function(){return{ip:"http://121.42.252.18:5000",deleteCatPopoverVisible:!1,filterKeyword:"",categoryCascader:[],categoryTree:[],categoryProps:{value:"id",children:"children",label:"name"},propertyData:[],selectedProperty:[],selectedCategory:{},selectedCategoryName:"",selectedParentCategory:[]}},watch:{filterKeyword:function(e){this.$refs.catTree.filter(e)},selectedCategory:function(){this.refreshParentCategory()}},methods:{loadCategories:function(){var e=this,t=this;t.$axios({method:"get",url:this.ip+"/admin/getAllCategory"}).then(function(e){if("success"===e.data.result){var a=e.data.treeData;t.categoryCascader=a,t.categoryTree=a[0].children}}).catch(function(t){var a=t.data,r=(a.error,a.errorMessage);e.$message({message:r,type:"error"})})},categoryFilter:function(e,t){return!e||-1!==t.name.toLowerCase().search(e.toLowerCase())},refreshCategoryCascader:function(e,t,a){var r=this;null!==e&&e.every(function(e){return a?(e.disabled=!0,"children"in e&&r.refreshCategoryCascader(e.children,t,!0),!0):(e.disabled=!1,e.id===t?(e.disabled=!0,"children"in e&&r.refreshCategoryCascader(e.children,t,!0)):"children"in e&&r.refreshCategoryCascader(e.children,t,!1),!0)})},onTreeItemClicked:function(e){console.log(e),this.selectedCategory=e,this.selectedCategoryName=e.name,this.refreshCategoryCascader(this.categoryCascader,this.selectedCategory.id,!1)},getCategoryPath:function(e,t,a){var r=this,s=[];return null!==e&&e.every(function(e){var o=[];return e.id===t?(s=a,!1):!("children"in e)||(o.push(e.id),s=r.getCategoryPath(e.children,t,a.concat(o)),0===s.length)}),s},getCategory:function(e,t){var a=this,r={};return e.every(function(e){return e.id===t?(r=e,!1):!("children"in e)||(r=a.getCategory(e.children,t),void 0===r.id)}),r},refreshParentCategory:function(){var e=this.getCategoryPath(this.categoryCascader,this.selectedCategory.id,[]);this.selectedParentCategory=e},createCategory:function(){var e=this;this.$axios({method:"post",url:this.ip+"/admin/category"}).then(function(t){if("success"===t.data.result){e.$message({message:"Successfully created new category",type:"success"});var a=t.data.category;e.categoryTree.push(a)}}).catch(function(t){var a=t.data,r=a.errorMessage;e.$message({message:r,type:"error"})})},updateCategoryName:function(){var e=this,t=this;t.$axios({method:"patch",url:this.ip+"/admin/category/changeName/"+t.selectedCategory.id,data:{name:t.selectedCategoryName}}).then(function(a){"success"===a.data.result&&(t.selectedCategory.name=t.selectedCategoryName,e.$message({message:"Successfully changed category name",type:"success"}))}).catch(function(t){var a=t.data,r=(a.error,a.errorMessage);e.$message({message:r,type:"error"})})},updateCategoryParent:function(){var e=this,t=this,a=t.$refs.catCascader.value,r=a[a.length-1];t.$axios({method:"patch",url:this.ip+"/admin/category/changeParent/"+t.selectedCategory.id,data:{superCategoryId:r}}).then(function(a){if("success"===a.data.result){var o=JSON.parse(s()(t.selectedCategory));t.performCategoryDelete();t.getCategory(t.categoryCascader,r).children.push(o),e.$message({message:"Successfully changed parent category",type:"success"})}}).catch(function(t){var a=t.data,r=(a.error,a.errorMessage);e.$message({message:r,type:"error"})})},performCategoryDelete:function(){for(var e=this,t=e.getCategory(e.categoryCascader,e.selectedCategory.id),a=e.getCategoryPath(e.categoryCascader,e.selectedCategory.id,[]),r=e.categoryCascader,s=0;s<a.length;s++)!function(s){var o=a[s],c=[];r.every(function(r){if(r.id===o){if(s===a.length-1){var n=r.children.indexOf(t);r.children.splice(n,1),e.selectedCategory={},e.selectedCategoryName="",e.selectedParentCategory=[]}else c=r.children;return!1}return!0}),r=c}(s)},deleteCategory:function(){var e=this,t=this;t.$axios({method:"delete",url:this.ip+"/admin/category/"+t.selectedCategory.id}).then(function(a){"success"===a.data.result&&(t.performCategoryDelete(),e.$message({message:"Successfully deleted category",type:"success"}))}).catch(function(t){var a=t.data,r=(a.error,a.errorMessage);e.$message({message:r,type:"error"})})},createProp:function(){var e=this,t=this;t.$axios({method:"post",url:this.ip+"/admin/category/"+t.selectedCategory.id}).then(function(t){e.$message({message:"Successfully created new property",type:"success"});var a=t.data,r=a.data.property;e.propertyData.push(r)}).catch(function(t){var a=t.data,r=(a.error,a.errorMessage);e.$message({message:r,type:"error"})})},updatePropName:function(e,t){var a=this,r=this;r.$axios({method:"patch",url:this.ip+"/api/admin/category/"+r.selectedCategory.id,data:{name:r.selectedCategory.name}}).then(function(e){a.$message({message:"Successfully updated property name",type:"success"})}).catch(function(e){var t=e.data,r=(t.error,t.errorMessage);a.$message({message:r,type:"error"})})},deleteProp:function(e,t){var a=this,r=this;r.$axios({method:"delete",url:this.ip+"/api/admin/category/"+r.selectedCategory.id+"/"+t.id}).then(function(e){a.$message({message:"Successfully deleted property",type:"success"});var r=a.propertyData.indexOf(t);a.propertyData.splice(r,1)}).catch(function(e){var t=e.data,r=(t.error,t.errorMessage);a.$message({message:r,type:"error"})})},deleteProps:function(){var e=this,t=this,a={property:t.selectedProperty};t.$axios({method:"delete",url:this.ip+"/api/admin/category/"+t.selectedCategory.id+"/property",data:a}).then(function(a){e.$message({message:"Successfully deleted selected properties",type:"success"});for(var r=0;r<t.selectedProperty.length;r++){var s=t.selectedProperty[r],o=e.propertyData.indexOf(s);e.propertyData.splice(o,1)}}).catch(function(t){var a=t.data,r=(a.error,a.errorMessage);e.$message({message:r,type:"error"})})},onPropSelectionChange:function(e){this.selectedProperty=e},handleAvatarSuccess:function(e,t){this.selectedCategory.url=URL.createObjectURL(t.raw),console.log("upload success")}},computed:{},mounted:function(){this.loadCategories()}}},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(e,t,a){var r=a("FeBl"),s=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}}});
//# sourceMappingURL=3.db18a2ba4982142991a0.js.map